import{Q as D,a as p,b as _,g}from"./QTable.54a77e6e.js";import{_ as A,n as w,o as z,c as C,w as a,f as d,a as l,e as n,aw as m,N as V,J as s,af as y,M as q,ax as E,ah as j,Q as T}from"./index.ef228992.js";import{Q as u}from"./QInput.a2bee355.js";import{Q as v}from"./QCardActions.bed2bb53.js";import{Q as x,a as k,b as U,c as M}from"./QPageSticky.a179ccb3.js";import{Q as B}from"./QPage.2fc420a1.js";import{T as O}from"./TouchPan.9047fff0.js";import{C as S}from"./ClosePopup.6197016b.js";import{api as h}from"./axios.23aa70c0.js";import{e as F}from"./export-file.dc78ba05.js";import{u as N}from"./use-quasar.38626e8f.js";import{a as b}from"./authenticate.bcdfbf4f.js";import"./format.6bd9982d.js";import"./use-key-composition.25c6204a.js";import"./QItemLabel.1cc16253.js";import"./js.cookie.f93afda9.js";function Q(o,i,c){let r=i!==void 0?i(o,c):o;return r=r==null?"":String(r),r=r.split('"').join('""'),`"${r}"`}const P=N(),L={name:"EquipoPage",data(){return{newEquipo:!1,editEquipo:!1,rows:[],columns:[{label:"Ficha ",name:"ficha",required:!1,align:"center",field:o=>o.ficha,format:o=>`${o}`,sortable:!0},{label:"Tipo Equipo ",name:"tipo.name",required:!1,align:"center",field:o=>o.tipo.name,format:o=>`${o}`,sortable:!0},{label:"Marca ",name:"marca.name",required:!1,align:"center",field:o=>o.marca.name,format:o=>`${o}`,sortable:!0},{label:"Modelo ",name:"modelo",required:!1,align:"center",field:o=>o.modelo,format:o=>`${o}`,sortable:!0},{label:"Placa del Equipo",name:"placa",required:!0,align:"center",field:o=>o.placa,format:o=>`${o}`,sortable:!0},{label:"Chasis",name:"chasis",required:!1,align:"center",field:o=>o.chasis,format:o=>`${o}`,sortable:!0},{label:"A\xF1o de Fabricaci\xF3n",name:"anno",required:!1,align:"center",field:o=>o.anno,format:o=>`${o}`,sortable:!0},{label:"Color ",name:"color",required:!1,align:"center",field:o=>o.color,format:o=>`${o}`,sortable:!0},{label:"Metraje ",name:"metraje",required:!1,align:"center",field:o=>o.metraje,format:o=>`${o}`,sortable:!0}],equipos:[],equipo:{placa:"",chasis:"",anno:"",color:"",ficha:"",idmarca:"",idtipo:"",metraje:"",modelo:""},ideselected:0,marcas:[],tipos:[]}},components:{},methods:{async loadEquipo(){await h.get("/equipos/",{headers:{Authorization:`Bearer ${b.getUserLogged()}`}}).then(o=>{this.rows=o.data}).catch(o=>this.$q.notify({type:"negative",position:"top",message:o.response.data.message}))},async loadMarca(){await h.get("/marca/",{headers:{Authorization:`Bearer ${b.getUserLogged()}`}}).then(o=>{this.marcas=o.data}).catch(o=>this.$q.notify({type:"negative",position:"top",message:o.response.data.message}))},async loadTipo(){await h.get("/tipo-equipo/",{headers:{Authorization:`Bearer ${b.getUserLogged()}`}}).then(o=>{this.tipos=o.data}).catch(o=>this.$q.notify({type:"negative",position:"top",message:o.response.data.message}))},OpenNewEquipo(){this.equipo.placa="",this.equipo.chasis="",this.equipo.anno="",this.equipo.color="",this.equipo.idmarca="",this.equipo.idtipo="",this.equipo.ficha="",this.equipo.metraje="",this.equipo.modelo="",this.newEquipo=!0},ClosedNewEquipo(){this.equipo.placa="",this.equipo.chasis="",this.equipo.anno="",this.equipo.color="",this.equipo.idmarca="",this.equipo.idtipo="",this.equipo.ficha="",this.equipo.metraje="",this.equipo.modelo="",this.newEquipo=!1},async AddEquipo(){console.log(this.equipo.marca),this.equipo.color!==""&this.equipo.idmarca!==""&this.equipo.idtipo!==""&this.equipo.ficha!==""?(await h.post("/equipos/",this.equipo,{headers:{Authorization:`Bearer ${b.getUserLogged()}`}}).then(o=>{this.$q.notify({color:"positive",position:"top",message:"Se inserto el Equipo "+o.data.placa,icon:"done"})}).catch(o=>this.$q.notify({type:"negative",position:"top",message:o.response.data.message})),this.newEquipo=!1,this.loadEquipo()):this.$q.notify({color:"negative",position:"top",message:"Llene los capos requeridos",icon:"report_problem"})},OpenEdit(){this.editEquipo=!0},async EditEquipo(){if(this.equipo.color!==""&this.equipo.idmarca!==""&this.equipo.idtipo!==""&this.equipo.ficha!==""){const o={placa:this.equipo.placa,chasis:this.equipo.chasis,anno:this.equipo.anno,color:this.equipo.color,idmarca:this.equipo.idmarca,idtipo:this.equipo.idtipo,ficha:this.equipo.ficha,metraje:this.equipo.metraje,modelo:this.equipo.modelo};await h.patch("/equipos/"+this.ideselected,o,{headers:{Authorization:`Bearer ${b.getUserLogged()}`}}).then(i=>{this.$q.notify({color:"positive",position:"top",message:"Se Modifico el Equipo "+i.data.placa,icon:"done"})}).catch(i=>this.$q.notify({type:"negative",position:"top",message:i.response.data.message})),this.editEquipo=!1,this.loadEquipo()}else this.$q.notify({color:"negative",position:"top",message:"Llene los capos requeridos",icon:"report_problem"})},ClosedEditEquipo(){this.equipo={},this.editEquipo=!1},async DeleteEquipo(){await h.delete("/equipos/"+this.idselected,{headers:{Authorization:`Bearer ${b.getUserLogged()}`}}).then(o=>{this.$q.notify({color:"positive",position:"top",message:"Se Elimino el Equipo "+o.data.placa,icon:"done"})}).catch(o=>this.$q.notify({type:"negative",position:"top",message:o.response.data.message})),this.confirm=!1,this.editEquipo=!1,this.loadEquipo()},onRowClick(o){this.ideselected=o.id,this.equipo.placa=o.placa,this.equipo.chasis=o.chasis,this.equipo.anno=o.anno,this.equipo.color=o.color,this.equipo.idmarca=o.marca.id,this.equipo.ficha=o.ficha,this.equipo.metraje=o.metraje,this.equipo.idtipo=o.tipo.id,this.equipo.modelo=o.modelo,this.editEquipo=!0},exportTable(){const o=[this.columns.map(c=>Q(c.label))].concat(this.rows.map(c=>this.columns.map(r=>Q(typeof r.field=="function"?r.field(c):c[r.field===void 0?r.name:r.field],r.format,c)).join(","))).join(`\r
`);F("table-export.csv",o,"text/csv")!==!0&&P.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}},mounted(){this.loadEquipo(),this.loadMarca(),this.loadTipo()},setup(){return{selected:w([]),confirm:w(!1)}}},R={class:"q-pa-md"},I={class:"q-pa-md q-gutter-sm"},J=d("div",{class:"text-h6"},"Nuevo Equipo",-1),G={class:"q-pa-md q-gutter-sm"},H=d("div",{class:"text-h6"},"Editar Equipo",-1),K={class:"q-pa-md q-gutter-sm"},W=d("span",{class:"q-ml-sm"},"Desea eliminar el Equipo?.",-1);function X(o,i,c,r,t,f){return z(),C(B,{class:"q-pa-md"},{default:a(()=>[d("div",R,[l(_,{flat:"",bordered:"",title:"Equipos",rows:t.rows,columns:t.columns,color:"primary","row-key":"name"},{body:a(e=>[l(D,{props:e,onClick:Y=>f.onRowClick(e.row)},{default:a(()=>[l(p,{key:"ficha",props:e},{default:a(()=>[n(m(e.row.ficha),1)]),_:2},1032,["props"]),l(p,{key:"tipo.name",props:e},{default:a(()=>[n(m(e.row.tipo.name),1)]),_:2},1032,["props"]),l(p,{key:"marca.name",props:e},{default:a(()=>[n(m(e.row.marca.name),1)]),_:2},1032,["props"]),l(p,{key:"modelo",props:e},{default:a(()=>[n(m(e.row.modelo),1)]),_:2},1032,["props"]),l(p,{key:"placa",props:e},{default:a(()=>[n(m(e.row.placa),1)]),_:2},1032,["props"]),l(p,{key:"chasis",props:e},{default:a(()=>[n(m(e.row.chasis),1)]),_:2},1032,["props"]),l(p,{key:"anno",props:e},{default:a(()=>[n(m(e.row.anno),1)]),_:2},1032,["props"]),l(p,{key:"color",props:e},{default:a(()=>[n(m(e.row.color),1)]),_:2},1032,["props"]),l(p,{key:"metraje",props:e},{default:a(()=>[n(m(e.row.metraje),1)]),_:2},1032,["props"])]),_:2},1032,["props","onClick"])]),_:1},8,["rows","columns"])]),d("template",null,[d("div",I,[l(E,{modelValue:t.newEquipo,"onUpdate:modelValue":i[11]||(i[11]=e=>t.newEquipo=e),persistent:""},{default:a(()=>[l(V,{class:"my-card",flat:"",bordered:""},{default:a(()=>[l(s,null,{default:a(()=>[J]),_:1}),l(y),l(s,{class:"horizontal"},{default:a(()=>[l(u,{filled:"",modelValue:t.equipo.ficha,"onUpdate:modelValue":i[0]||(i[0]=e=>t.equipo.ficha=e),label:"Ficha",mask:"S - ####"},null,8,["modelValue"])]),_:1}),l(s,{class:"horizontal"},{default:a(()=>[l(u,{filled:"",modelValue:t.equipo.placa,"onUpdate:modelValue":i[1]||(i[1]=e=>t.equipo.placa=e),label:"Placa *","lazy-rules":"",rules:[e=>e&&e.length>0||"Debe introducir una placa "]},null,8,["modelValue","rules"])]),_:1}),l(s,{class:"horizontal"},{default:a(()=>[l(u,{filled:"",modelValue:t.equipo.chasis,"onUpdate:modelValue":i[2]||(i[2]=e=>t.equipo.chasis=e),label:"Chasis *","lazy-rules":"",rules:[e=>e&&e.length>0||"Debe introducir un numero de serie "]},null,8,["modelValue","rules"])]),_:1}),l(s,{class:"horizontal"},{default:a(()=>[l(u,{filled:"",modelValue:t.equipo.modelo,"onUpdate:modelValue":i[3]||(i[3]=e=>t.equipo.modelo=e),label:"Modelo *","lazy-rules":"",rules:[e=>e&&e.length>0||"Debe introducir modelo "]},null,8,["modelValue","rules"])]),_:1}),l(s,{class:"horizontal"},{default:a(()=>[l(u,{filled:"",modelValue:t.equipo.anno,"onUpdate:modelValue":i[4]||(i[4]=e=>t.equipo.anno=e),label:"A\xF1o *",mask:"####","lazy-rules":"",rules:[e=>e&&e>1900&&e<3e3||"Debe introducir el a\xF1o de frabricaci\xF3n del equipo "]},null,8,["modelValue","rules"])]),_:1}),l(s,{class:"horizontal"},{default:a(()=>[l(u,{filled:"",modelValue:t.equipo.color,"onUpdate:modelValue":i[5]||(i[5]=e=>t.equipo.color=e),label:"Color *","lazy-rules":"",rules:[e=>e&&e.length>0||"Debe introducir el color del equipo "]},null,8,["modelValue","rules"])]),_:1}),l(s,{class:"horizontal"},{default:a(()=>[l(g,{filled:"",modelValue:t.equipo.idmarca,"onUpdate:modelValue":i[6]||(i[6]=e=>t.equipo.idmarca=e),options:t.marcas,"option-value":e=>Object(e)===e&&"id"in e?e.id:null,"option-label":e=>Object(e)===e&&"name"in e?e.name:"- Marca -","emit-value":"","map-options":""},null,8,["modelValue","options","option-value","option-label"])]),_:1}),l(s,{class:"horizontal"},{default:a(()=>[l(g,{filled:"",modelValue:t.equipo.idtipo,"onUpdate:modelValue":i[7]||(i[7]=e=>t.equipo.idtipo=e),options:t.tipos,"option-value":e=>Object(e)===e&&"id"in e?e.id:null,"option-label":e=>Object(e)===e&&"name"in e?e.name:"- Tipo de Equipo -","emit-value":"","map-options":""},null,8,["modelValue","options","option-value","option-label"])]),_:1}),l(s,{class:"horizontal"},{default:a(()=>[l(u,{modelValue:t.equipo.metraje,"onUpdate:modelValue":i[8]||(i[8]=e=>t.equipo.metraje=e),filled:"",type:"textarea",label:"Metraje"},null,8,["modelValue"])]),_:1}),l(y),l(s,{class:"horizontal"},{default:a(()=>[l(v,null,{default:a(()=>[l(q,{label:"Enviar",icon:"send",type:"submit",color:"primary",flat:"",class:"q-ml-sm",onClick:i[9]||(i[9]=e=>f.AddEquipo())}),l(q,{label:"Cancelar",icon:"cancel",type:"reset",color:"primary",flat:"",class:"q-ml-sm",onClick:i[10]||(i[10]=e=>f.ClosedNewEquipo())})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),d("template",null,[d("div",G,[l(E,{modelValue:t.editEquipo,"onUpdate:modelValue":i[24]||(i[24]=e=>t.editEquipo=e),persistent:""},{default:a(()=>[l(V,{class:"my-card",flat:"",bordered:""},{default:a(()=>[l(s,null,{default:a(()=>[H]),_:1}),l(y),l(s,{class:"horizontal"},{default:a(()=>[l(u,{filled:"",modelValue:t.equipo.ficha,"onUpdate:modelValue":i[12]||(i[12]=e=>t.equipo.ficha=e),label:"Ficha",mask:"S - ####"},null,8,["modelValue"])]),_:1}),l(s,{class:"horizontal"},{default:a(()=>[l(u,{filled:"",modelValue:t.equipo.placa,"onUpdate:modelValue":i[13]||(i[13]=e=>t.equipo.placa=e),label:"Placa *","lazy-rules":"",rules:[e=>e&&e.length>0||"Debe introducir una placa "]},null,8,["modelValue","rules"])]),_:1}),l(s,{class:"horizontal"},{default:a(()=>[l(u,{filled:"",modelValue:t.equipo.modelo,"onUpdate:modelValue":i[14]||(i[14]=e=>t.equipo.modelo=e),label:"Modelo *","lazy-rules":"",rules:[e=>e&&e.length>0||"Debe introducir modelo "]},null,8,["modelValue","rules"])]),_:1}),l(s,{class:"horizontal"},{default:a(()=>[l(u,{filled:"",modelValue:t.equipo.chasis,"onUpdate:modelValue":i[15]||(i[15]=e=>t.equipo.chasis=e),label:"Chasis *","lazy-rules":"",rules:[e=>e&&e.length>0||"Debe introducir un numero de serie "]},null,8,["modelValue","rules"])]),_:1}),l(s,{class:"horizontal"},{default:a(()=>[l(u,{filled:"",modelValue:t.equipo.anno,"onUpdate:modelValue":i[16]||(i[16]=e=>t.equipo.anno=e),label:"A\xF1o *",mask:"####","lazy-rules":"",rules:[e=>e&&e>1900&&e<3e3||"Debe introducir el a\xF1o de frabricaci\xF3n del equipo "]},null,8,["modelValue","rules"])]),_:1}),l(s,{class:"horizontal"},{default:a(()=>[l(u,{filled:"",modelValue:t.equipo.color,"onUpdate:modelValue":i[17]||(i[17]=e=>t.equipo.color=e),label:"Color *","lazy-rules":"",rules:[e=>e&&e.length>0||"Debe introducir un color "]},null,8,["modelValue","rules"])]),_:1}),l(s,{class:"horizontal"},{default:a(()=>[l(g,{filled:"",modelValue:t.equipo.idmarca,"onUpdate:modelValue":i[18]||(i[18]=e=>t.equipo.idmarca=e),options:t.marcas,"option-value":e=>Object(e)===e&&"id"in e?e.id:null,"option-label":e=>Object(e)===e&&"name"in e?e.name:"- Marca -","emit-value":"","map-options":""},null,8,["modelValue","options","option-value","option-label"])]),_:1}),l(s,{class:"horizontal"},{default:a(()=>[l(g,{filled:"",modelValue:t.equipo.idtipo,"onUpdate:modelValue":i[19]||(i[19]=e=>t.equipo.idtipo=e),options:t.tipos,"option-value":e=>Object(e)===e&&"id"in e?e.id:null,"option-label":e=>Object(e)===e&&"name"in e?e.name:"- Tipo de Equipo -","emit-value":"","map-options":""},null,8,["modelValue","options","option-value","option-label"])]),_:1}),l(s,{class:"horizontal"},{default:a(()=>[l(u,{modelValue:t.equipo.metraje,"onUpdate:modelValue":i[20]||(i[20]=e=>t.equipo.metraje=e),filled:"",type:"textarea",label:"Metraje"},null,8,["modelValue"])]),_:1}),l(y),l(s,{class:"horizontal"},{default:a(()=>[l(v,null,{default:a(()=>[l(q,{label:"Enviar",icon:"send",type:"submit",color:"primary",flat:"",class:"q-ml-sm",onClick:i[21]||(i[21]=e=>f.EditEquipo())}),l(q,{label:"Eliminar",icon:"delete",type:"submit",color:"negative",flat:"",class:"q-ml-sm",onClick:i[22]||(i[22]=e=>r.confirm=!0)}),l(q,{label:"Cerrar",icon:"cancel",type:"cancel",color:"primary",flat:"",class:"q-ml-sm",onClick:i[23]||(i[23]=e=>f.ClosedEditEquipo())})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),l(M,{position:"top-right",offset:[18,18]},{default:a(()=>[j((z(),C(x,{icon:"add",direction:"down",color:"primary",disable:o.draggingFab},{default:a(()=>[l(k,{onClick:i[25]||(i[25]=e=>f.exportTable()),color:"positive",icon:"download",disable:o.draggingFab},{default:a(()=>[l(U,null,{default:a(()=>[n(" Descargar ")]),_:1})]),_:1},8,["disable"]),l(k,{onClick:i[26]||(i[26]=e=>f.OpenNewEquipo()),color:"positive",icon:"add_box",disable:o.draggingFab},{default:a(()=>[l(U,null,{default:a(()=>[n(" Nuevo ")]),_:1})]),_:1},8,["disable"])]),_:1},8,["disable"])),[[O,o.moveFab,void 0,{prevent:!0,mouse:!0}]])]),_:1}),d("template",null,[d("div",K,[l(E,{modelValue:r.confirm,"onUpdate:modelValue":i[28]||(i[28]=e=>r.confirm=e),persistent:""},{default:a(()=>[l(V,null,{default:a(()=>[l(s,{class:"row items-center"},{default:a(()=>[l(T,{icon:"priority_high",color:"primary","text-color":"white"}),W]),_:1}),l(v,{align:"right"},{default:a(()=>[j(l(q,{label:"Cancelar",icon:"cancel",type:"cancel",color:"primary",flat:"",class:"q-ml-sm"},null,512),[[S]]),l(q,{label:"Eliminar",icon:"delete",type:"submit",color:"negative",flat:"",class:"q-ml-sm",onClick:i[27]||(i[27]=e=>f.DeleteEquipo())})]),_:1})]),_:1})]),_:1},8,["modelValue"])])])]),_:1})}var fe=A(L,[["render",X]]);export{fe as default};
