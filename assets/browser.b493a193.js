var c=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},s={exports:{}};(function(u,p){(function(i,t){u.exports=t})(c,function(i){var t={};t.defaults={key:"JWT_TOKEN",tokenPrefix:"Bearer ",storage:i.localStorage,padding:!1},t.encode64=function(e){var r=i.btoa(i.unescape(i.encodeURIComponent(e)));return t.defaults.padding?r:r.replace(/=+$/,"")},t.decode64=function(e){return i.decodeURIComponent(i.escape(i.atob(e)))},t.write=function(e){return t.defaults.tokenPrefix+t.encode64(JSON.stringify(e.header))+"."+t.encode64(JSON.stringify(e.claim))+"."+(e.signature||"")},t.read=function(e){e.indexOf(t.defaults.tokenPrefix)===0&&(e=e.substring(t.defaults.tokenPrefix.length));var r=e.split(".");return{header:JSON.parse(t.decode64(r[0])),claim:JSON.parse(t.decode64(r[1])),signature:r[2]||""}},t.validateClaim=function(e,r,o){var d=Date.now()/1e3;return e&&(!e.exp||e.exp>d)&&(!e.nbf||e.nbf<d)&&(r===void 0||r===e.iss)&&(o===void 0||o===e.aud)},t.validate=function(e,r,o){return f(e)&&(e=t.read(e)),e&&e.claim&&t.validateClaim(e.claim,r,o)},t.set=function(e,r,o){var d=a(r,o);return d.storage.setItem(d.key,e)},t.get=function(e,r){var o=a(e,r);return o.storage.getItem(o.key)},t.remove=function(e,r){var o=a(e,r);return o.storage.removeItem(o.key)},t.keep=function(e,r,o){return t.set(f(e)?e:t.write(e),r,o)},t.remember=function(e,r){var o=t.get(e,r);return o&&t.read(o)},t.forget=t.remove;function f(n){return typeof n=="string"||n&&typeof n=="object"&&Object.prototype.toString.call(n)=="[object String]"||!1}function a(n,e){return n&&!f(n)&&(e=n,n=void 0),{key:n||t.defaults.key,storage:e||t.defaults.storage}}return t})})(s);var g=s.exports(window);export{g as b};
