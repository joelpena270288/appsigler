import{Q as N,a as S,b as D}from"./QTable.54a77e6e.js";import{_ as U,n as w,o as q,c as C,w as s,f as a,a as i,e as v,aw as V,N as h,J as m,af as f,M as c,ax as b,ah as Q,Q as E}from"./index.ef228992.js";import{Q as g}from"./QInput.a2bee355.js";import{Q as y}from"./QCardActions.bed2bb53.js";import{Q as A,a as _,b as k,c as B}from"./QPageSticky.a179ccb3.js";import{Q as T}from"./QPage.2fc420a1.js";import{T as z}from"./TouchPan.9047fff0.js";import{C as L}from"./ClosePopup.6197016b.js";import{api as p}from"./axios.23aa70c0.js";import{e as $}from"./export-file.dc78ba05.js";import{u as F}from"./use-quasar.38626e8f.js";import{a as u}from"./authenticate.bcdfbf4f.js";import"./format.6bd9982d.js";import"./use-key-composition.25c6204a.js";import"./QItemLabel.1cc16253.js";import"./js.cookie.f93afda9.js";function x(e,o,n){let r=o!==void 0?o(e,n):e;return r=r==null?"":String(r),r=r.split('"').join('""'),`"${r}"`}const P=F(),j={name:"ServicioPage",data(){return{newServicio:!1,editServicio:!1,rows:[],columns:[{label:"Nombre del Servicio",name:"name",required:!0,align:"center",field:e=>e.name,format:e=>`${e}`,sortable:!0},{label:"Descripcion del Servicio",name:"descripcion",required:!1,align:"center",field:e=>e.descripcion,format:e=>`${e}`,sortable:!0}],servicios:[],servicio:{name:"",descripcion:""},ideselected:0}},components:{},methods:{loadServicio(){p.get("/servicio/",{headers:{Authorization:`Bearer ${u.getUserLogged()}`}}).then(e=>{this.rows=e.data}).catch(e=>this.$q.notify({type:"negative",position:"top",message:e.response.data.message}))},loadImpuesto(){p.get("/impuestos/",{headers:{Authorization:`Bearer ${u.getUserLogged()}`}}).then(e=>{this.impuestos=e.data}).catch(e=>this.$q.notify({type:"negative",position:"top",message:e.response.data.message}))},OpenNewServicio(){this.servicio.name="",this.servicio.descripcion="",this.newServicio=!0},ClosedNewServicio(){this.servicio.name="",this.servicio.descripcion="",this.newServicio=!1},async AddServicio(){this.servicio.name!==""?(await p.post("/servicio/",this.servicio,{headers:{Authorization:`Bearer ${u.getUserLogged()}`}}).then(e=>{this.$q.notify({color:"positive",position:"top",message:"Se inserto el Servicio "+e.data.name,icon:"done"})}).catch(e=>this.$q.notify({type:"negative",position:"top",message:e.response.data.message})),this.newServicio=!1,this.loadServicio()):this.$q.notify({color:"negative",position:"top",message:"Llene los capos requeridos",icon:"report_problem"})},OpenEdit(){this.editServicio=!0},async EditServicio(){this.servicio.name!==""?(await p.patch("/servicio/"+this.idselected,this.servicio,{headers:{Authorization:`Bearer ${u.getUserLogged()}`}}).then(e=>{this.$q.notify({color:"positive",position:"top",message:"Se Modifico el Servicio "+e.data.name,icon:"done"})}).catch(e=>this.$q.notify({type:"negative",position:"top",message:e.response.data.message})),this.editServicio=!1,this.loadServicio()):this.$q.notify({color:"negative",position:"top",message:"Llene los capos requeridos",icon:"report_problem"})},ClosedEditServicio(){this.servicio={},this.editServicio=!1},async DeleteServicio(){await p.delete("/servicio/"+this.idselected,{headers:{Authorization:`Bearer ${u.getUserLogged()}`}}).then(e=>{this.$q.notify({color:"positive",position:"top",message:"Se Elimino el Servicio "+e.data.name,icon:"done"})}).catch(e=>this.$q.notify({type:"negative",position:"top",message:e.response.data.message})),this.confirm=!1,this.editServicio=!1,this.loadServicio()},onRowClick(e){this.servicio.name=e.name,this.servicio.descripcion=e.descripcion,this.idselected=e.id,this.editServicio=!0},exportTable(){const e=[this.columns.map(n=>x(n.label))].concat(this.rows.map(n=>this.columns.map(r=>x(typeof r.field=="function"?r.field(n):n[r.field===void 0?r.name:r.field],r.format,n)).join(","))).join(`\r
`);$("table-export.csv",e,"text/csv")!==!0&&P.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}},mounted(){this.loadServicio(),this.loadImpuesto()},setup(){return{selected:w([]),confirm:w(!1)}}},I={class:"q-pa-md"},O={class:"q-pa-md q-gutter-sm"},M=a("div",{class:"text-h6"},"Nuevo Servicio",-1),R={class:"q-pt-none",style:{"max-width":"700px"}},J={class:"q-pa-md q-gutter-sm"},G=a("div",{class:"text-h6"},"Editar Servicio",-1),H={class:"q-pt-none",style:{"max-width":"700px"}},K={class:"q-pa-md q-gutter-sm"},W=a("span",{class:"q-ml-sm"},"Desea eliminar el Servicio?.",-1);function X(e,o,n,r,l,d){return q(),C(T,{class:"q-pa-md"},{default:s(()=>[a("div",I,[i(D,{flat:"",bordered:"",title:"Servicios",rows:l.rows,columns:l.columns,color:"primary","row-key":"name"},{body:s(t=>[i(N,{props:t,onClick:Y=>d.onRowClick(t.row)},{default:s(()=>[i(S,{key:"name",props:t},{default:s(()=>[v(V(t.row.name),1)]),_:2},1032,["props"]),i(S,{key:"descripcion",props:t},{default:s(()=>[v(V(t.row.descripcion),1)]),_:2},1032,["props"])]),_:2},1032,["props","onClick"])]),_:1},8,["rows","columns"])]),a("template",null,[a("div",O,[i(b,{modelValue:l.newServicio,"onUpdate:modelValue":o[4]||(o[4]=t=>l.newServicio=t),persistent:""},{default:s(()=>[i(h,{class:"my-card",flat:"",bordered:""},{default:s(()=>[i(m,null,{default:s(()=>[M]),_:1}),i(f),i(m,null,{default:s(()=>[a("div",R,[i(g,{filled:"",modelValue:l.servicio.name,"onUpdate:modelValue":o[0]||(o[0]=t=>l.servicio.name=t),label:"Nombre *","lazy-rules":"",rules:[t=>t&&t.length>0||"Debe introducir un Nombre "]},null,8,["modelValue","rules"]),i(g,{modelValue:l.servicio.descripcion,"onUpdate:modelValue":o[1]||(o[1]=t=>l.servicio.descripcion=t),filled:"",type:"textarea",label:"Descripcion",hint:"Descripcion del servicio"},null,8,["modelValue"])])]),_:1}),i(f),i(y,null,{default:s(()=>[i(c,{label:"Enviar",icon:"send",type:"submit",color:"primary",flat:"",class:"q-ml-sm",onClick:o[2]||(o[2]=t=>d.AddServicio())}),i(c,{label:"Cancelar",icon:"cancel",type:"reset",color:"primary",flat:"",class:"q-ml-sm",onClick:o[3]||(o[3]=t=>d.ClosedNewServicio())})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),a("template",null,[a("div",J,[i(b,{modelValue:l.editServicio,"onUpdate:modelValue":o[10]||(o[10]=t=>l.editServicio=t),persistent:""},{default:s(()=>[i(h,{class:"my-card",flat:"",bordered:""},{default:s(()=>[i(m,null,{default:s(()=>[G]),_:1}),i(f),i(m,null,{default:s(()=>[a("div",H,[i(g,{filled:"",modelValue:l.servicio.name,"onUpdate:modelValue":o[5]||(o[5]=t=>l.servicio.name=t),label:"Nombre *",hint:"Nombre del servicio","lazy-rules":"",rules:[t=>t&&t.length>0||"Debe introducir un Nombre"]},null,8,["modelValue","rules"]),i(g,{modelValue:l.servicio.descripcion,"onUpdate:modelValue":o[6]||(o[6]=t=>l.servicio.descripcion=t),filled:"",type:"textarea",label:"Descripcion",hint:"Descripcion del servicio"},null,8,["modelValue"])])]),_:1}),i(f),i(y,null,{default:s(()=>[i(c,{label:"Enviar",icon:"send",type:"submit",color:"primary",flat:"",class:"q-ml-sm",onClick:o[7]||(o[7]=t=>d.EditServicio())}),i(c,{label:"Eliminar",icon:"delete",type:"submit",color:"negative",flat:"",class:"q-ml-sm",onClick:o[8]||(o[8]=t=>r.confirm=!0)}),i(c,{label:"Cerrar",icon:"cancel",type:"cancel",color:"primary",flat:"",class:"q-ml-sm",onClick:o[9]||(o[9]=t=>d.ClosedEditServicio())})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),i(B,{position:"top-right",offset:[18,18]},{default:s(()=>[Q((q(),C(A,{icon:"add",direction:"down",color:"primary",disable:e.draggingFab},{default:s(()=>[i(_,{onClick:o[11]||(o[11]=t=>d.exportTable()),color:"positive",icon:"download",disable:e.draggingFab},{default:s(()=>[i(k,null,{default:s(()=>[v(" Descargar ")]),_:1})]),_:1},8,["disable"]),i(_,{onClick:o[12]||(o[12]=t=>d.OpenNewServicio()),color:"positive",icon:"add_box",disable:e.draggingFab},{default:s(()=>[i(k,null,{default:s(()=>[v(" Nuevo ")]),_:1})]),_:1},8,["disable"])]),_:1},8,["disable"])),[[z,e.moveFab,void 0,{prevent:!0,mouse:!0}]])]),_:1}),a("template",null,[a("div",K,[i(b,{modelValue:r.confirm,"onUpdate:modelValue":o[14]||(o[14]=t=>r.confirm=t),persistent:""},{default:s(()=>[i(h,null,{default:s(()=>[i(m,{class:"row items-center"},{default:s(()=>[i(E,{icon:"priority_high",color:"primary","text-color":"white"}),W]),_:1}),i(y,{align:"right"},{default:s(()=>[Q(i(c,{label:"Cancelar",icon:"cancel",type:"cancel",color:"primary",flat:"",class:"q-ml-sm"},null,512),[[L]]),i(c,{label:"Eliminar",icon:"delete",type:"submit",color:"negative",flat:"",class:"q-ml-sm",onClick:o[13]||(o[13]=t=>d.DeleteServicio())})]),_:1})]),_:1})]),_:1},8,["modelValue"])])])]),_:1})}var fe=U(j,[["render",X]]);export{fe as default};
