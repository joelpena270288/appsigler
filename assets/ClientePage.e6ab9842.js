import{Q as U,a as p,b as T}from"./QTable.54a77e6e.js";import{Q as D,a as q,b as w,c as E}from"./QPageSticky.a179ccb3.js";import{_ as A,n as B,o as Q,c as N,w as o,f as a,a as e,e as u,aw as b,ah as k,N as y,J as f,af as C,M as m,ax as v,ag as S,aj as _,Q as L}from"./index.ef228992.js";import{Q as c}from"./QInput.a2bee355.js";import{Q as V}from"./QCardActions.bed2bb53.js";import{Q as R}from"./QItemLabel.1cc16253.js";import{Q as z}from"./QPage.2fc420a1.js";import{T as F}from"./TouchPan.9047fff0.js";import{C as P}from"./ClosePopup.6197016b.js";import{api as g}from"./axios.23aa70c0.js";import{e as j}from"./export-file.dc78ba05.js";import{u as I}from"./use-quasar.38626e8f.js";import{a as h}from"./authenticate.bcdfbf4f.js";import"./format.6bd9982d.js";import"./use-key-composition.25c6204a.js";import"./js.cookie.f93afda9.js";function x(l,i,d){let s=i!==void 0?i(l,d):l;return s=s==null?"":String(s),s=s.split('"').join('""'),`"${s}"`}const O=I(),M={name:"ClientePage",data(){return{newCliente:!1,editCliente:!1,rows:[],columns:[{label:"Nombre",name:"nombre",required:!0,align:"center",field:l=>l.nombre,format:l=>`${l}`,sortable:!0},{label:"Direccion",name:"direccion",required:!1,align:"center",field:l=>l.direccion,format:l=>`${l}`,sortable:!0},{label:"Telefono",name:"telefono",required:!1,align:"center",field:l=>l.telefono,format:l=>`${l}`,sortable:!0},{label:"RNC",name:"rcn",required:!1,align:"center",field:l=>l.rcn,format:l=>`${l}`,sortable:!0}],clientes:[],cliente:{nombre:"",direccion:"",telefono:"",rcn:""},roles:[]}},components:{},methods:{loadCliente(){g.get("/cliente/",{headers:{Authorization:`Bearer ${h.getUserLogged()}`}}).then(l=>{this.rows=l.data}).catch(l=>this.$q.notify({type:"negative",position:"top",message:l.response.data.message}))},OpenNewCliente(){this.cliente.nombre="",this.cliente.direccion="",this.cliente.telefono="",this.cliente.rcn="",this.newCliente=!0},ClosedNewCliente(){this.cliente.nombre="",this.cliente.direccion="",this.cliente.telefono="",this.cliente.rcn="",this.newCliente=!1},async AddCliente(){this.cliente.nombre!==""?(await g.post("/cliente/",this.cliente,{headers:{Authorization:`Bearer ${h.getUserLogged()}`}}).then(l=>{this.$q.notify({color:"positive",position:"top",message:"Se inserto el cliente "+l.data.nombre,icon:"done"})}).catch(l=>this.$q.notify({type:"negative",position:"top",message:l.response.data.message})),this.newCliente=!1,this.loadCliente()):this.$q.notify({color:"negative",position:"top",message:"Llene los capos requeridos",icon:"report_problem"})},OpenEdit(){this.editUser=!0},async EditCliente(){this.cliente.nombre!==""?(await g.patch("/cliente/"+this.idselected,this.cliente,{headers:{Authorization:`Bearer ${h.getUserLogged()}`}}).then(l=>{this.$q.notify({color:"positive",position:"top",message:"Se Modifico el cliente "+l.data.nombre,icon:"done"})}).catch(l=>this.$q.notify({type:"negative",position:"top",message:l.response.data.message})),this.editCliente=!1,this.loadCliente()):this.$q.notify({color:"negative",position:"top",message:"Llene los capos requeridos",icon:"report_problem"})},ClosedEditCliente(){this.cliente={},this.editCliente=!1},async DeleteCliente(){await g.delete("/cliente/"+this.idselected,{headers:{Authorization:`Bearer ${h.getUserLogged()}`}}).then(l=>{this.$q.notify({color:"positive",position:"top",message:"Se Elimino el cliente del sistema "+l.data.nombre,icon:"done"})}).catch(l=>this.$q.notify({type:"negative",position:"top",message:l.response.data.message})),this.confirm=!1,this.editCliente=!1,this.loadCliente()},onRowClick(l){this.cliente.nombre=l.nombre,this.cliente.direccion=l.direccion,this.cliente.telefono=l.telefono,this.cliente.rcn=l.rcn,this.idselected=l.id,this.editCliente=!0},exportTable(){const l=[this.columns.map(d=>x(d.label))].concat(this.rows.map(d=>this.columns.map(s=>x(typeof s.field=="function"?s.field(d):d[s.field===void 0?s.name:s.field],s.format,d)).join(","))).join(`\r
`);j("table-export.csv",l,"text/csv")!==!0&&O.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}},mounted(){this.loadCliente()},setup(){return{confirm:B(!1)}}},J={class:"q-pa-md"},G={class:"q-pa-md q-gutter-sm"},H=a("div",{class:"text-h6"},"Nuevo Cliente",-1),K={class:"q-pt-none",style:{"max-width":"700px"}},W={class:"q-pa-md q-gutter-sm"},X={class:"q-pt-none",style:{"max-width":"700px"}},Y={class:"q-pa-md q-gutter-sm"},Z=a("span",{class:"q-ml-sm"},"Desea eliminar el Cliente?.",-1);function $(l,i,d,s,n,r){return Q(),N(z,{class:"q-pa-md"},{default:o(()=>[a("div",J,[e(T,{flat:"",bordered:"",title:"Clientes",rows:n.rows,columns:n.columns,color:"primary","row-key":"name"},{body:o(t=>[e(U,{props:t,onClick:ee=>r.onRowClick(t.row)},{default:o(()=>[e(p,{key:"nombre",props:t},{default:o(()=>[u(b(t.row.nombre),1)]),_:2},1032,["props"]),e(p,{key:"direccion",props:t},{default:o(()=>[u(b(t.row.direccion),1)]),_:2},1032,["props"]),e(p,{key:"telefono",props:t},{default:o(()=>[u(b(t.row.telefono),1)]),_:2},1032,["props"]),e(p,{key:"rcn",props:t},{default:o(()=>[u(b(t.row.rcn),1)]),_:2},1032,["props"])]),_:2},1032,["props","onClick"])]),_:1},8,["rows","columns"])]),e(E,{position:"top-right",offset:[18,18]},{default:o(()=>[k((Q(),N(D,{icon:"add",direction:"down",color:"primary",disable:l.draggingFab},{default:o(()=>[e(q,{onClick:i[0]||(i[0]=t=>r.exportTable()),color:"positive",icon:"download",disable:l.draggingFab},{default:o(()=>[e(w,null,{default:o(()=>[u(" Descargar ")]),_:1})]),_:1},8,["disable"]),e(q,{onClick:i[1]||(i[1]=t=>r.OpenNewCliente()),color:"positive",icon:"person_add",disable:l.draggingFab},{default:o(()=>[e(w,null,{default:o(()=>[u(" Nuevo ")]),_:1})]),_:1},8,["disable"])]),_:1},8,["disable"])),[[F,l.moveFab,void 0,{prevent:!0,mouse:!0}]])]),_:1}),a("template",null,[a("div",G,[e(v,{modelValue:n.newCliente,"onUpdate:modelValue":i[8]||(i[8]=t=>n.newCliente=t),persistent:""},{default:o(()=>[e(y,{class:"my-card",flat:"",bordered:""},{default:o(()=>[e(f,null,{default:o(()=>[H]),_:1}),e(C),e(f,null,{default:o(()=>[a("div",K,[e(c,{filled:"",modelValue:n.cliente.nombre,"onUpdate:modelValue":i[2]||(i[2]=t=>n.cliente.nombre=t),label:"Nombre *",hint:"Nombre del Cliente","lazy-rules":"",rules:[t=>t&&t.length>0||"Debe introducir un nombre "]},null,8,["modelValue","rules"]),e(c,{filled:"",modelValue:n.cliente.telefono,"onUpdate:modelValue":i[3]||(i[3]=t=>n.cliente.telefono=t),label:"Numero de Telefono",mask:"(###) ### - ####",hint:"Numero de Telefono"},null,8,["modelValue"]),e(c,{filled:"",modelValue:n.cliente.rcn,"onUpdate:modelValue":i[4]||(i[4]=t=>n.cliente.rcn=t),label:"RNC",hint:"RNC"},null,8,["modelValue"]),e(c,{modelValue:n.cliente.direccion,"onUpdate:modelValue":i[5]||(i[5]=t=>n.cliente.direccion=t),filled:"",type:"textarea",label:"Direccion"},null,8,["modelValue"])])]),_:1}),e(C),e(V,null,{default:o(()=>[e(m,{label:"Enviar",icon:"send",type:"submit",color:"primary",flat:"",class:"q-ml-sm",onClick:i[6]||(i[6]=t=>r.AddCliente())}),e(m,{label:"Cancelar",icon:"cancel",type:"reset",color:"primary",flat:"",class:"q-ml-sm",onClick:i[7]||(i[7]=t=>r.ClosedNewCliente())})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),a("template",null,[a("div",W,[e(v,{modelValue:n.editCliente,"onUpdate:modelValue":i[17]||(i[17]=t=>n.editCliente=t),persistent:""},{default:o(()=>[e(y,{class:"my-card",flat:"",bordered:""},{default:o(()=>[e(f,null,{default:o(()=>[e(S,null,{default:o(()=>[e(_,null,{default:o(()=>[e(R,{class:"text-h6"},{default:o(()=>[u("Editar Cliente")]),_:1})]),_:1}),e(_,null,{default:o(()=>[e(m,{icon:"contact_phone",type:"submit",color:"primary",flat:"",class:"q-ml-sm",onClick:i[9]||(i[9]=t=>r.ClosedEditCliente())})]),_:1})]),_:1})]),_:1}),e(C),e(f,null,{default:o(()=>[a("div",X,[e(c,{filled:"",modelValue:n.cliente.nombre,"onUpdate:modelValue":i[10]||(i[10]=t=>n.cliente.nombre=t),label:"Nombre *",hint:"Nombre del Cliente","lazy-rules":"",rules:[t=>t&&t.length>0||"Debe introducir un nombre "]},null,8,["modelValue","rules"]),e(c,{filled:"",modelValue:n.cliente.telefono,"onUpdate:modelValue":i[11]||(i[11]=t=>n.cliente.telefono=t),label:"Numero de Telefono",mask:"(###) ### - ####",hint:"Numero de Telefono"},null,8,["modelValue"]),e(c,{filled:"",modelValue:n.cliente.rcn,"onUpdate:modelValue":i[12]||(i[12]=t=>n.cliente.rcn=t),label:"RNC",hint:"RNC"},null,8,["modelValue"]),e(c,{modelValue:n.cliente.direccion,"onUpdate:modelValue":i[13]||(i[13]=t=>n.cliente.direccion=t),filled:"",type:"textarea",label:"Direccion"},null,8,["modelValue"])])]),_:1}),e(C),e(V,null,{default:o(()=>[e(m,{label:"Enviar",icon:"send",type:"submit",color:"primary",flat:"",class:"q-ml-sm",onClick:i[14]||(i[14]=t=>r.EditCliente())}),e(m,{label:"Eliminar",icon:"delete",type:"submit",color:"negative",flat:"",class:"q-ml-sm",onClick:i[15]||(i[15]=t=>s.confirm=!0)}),e(m,{label:"Cerrar",icon:"cancel",type:"cancel",color:"primary",flat:"",class:"q-ml-sm",onClick:i[16]||(i[16]=t=>r.ClosedEditCliente())})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),a("template",null,[a("div",Y,[e(v,{modelValue:s.confirm,"onUpdate:modelValue":i[19]||(i[19]=t=>s.confirm=t),persistent:""},{default:o(()=>[e(y,null,{default:o(()=>[e(f,{class:"row items-center"},{default:o(()=>[e(L,{icon:"priority_high",color:"primary","text-color":"white"}),Z]),_:1}),e(V,{align:"right"},{default:o(()=>[k(e(m,{label:"Cancelar",icon:"cancel",type:"cancel",color:"primary",flat:"",class:"q-ml-sm"},null,512),[[P]]),e(m,{label:"Eliminar",icon:"delete",type:"submit",color:"negative",flat:"",class:"q-ml-sm",onClick:i[18]||(i[18]=t=>r.DeleteCliente())})]),_:1})]),_:1})]),_:1},8,["modelValue"])])])]),_:1})}var ge=A(M,[["render",$]]);export{ge as default};
