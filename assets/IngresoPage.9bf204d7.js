import{Q as h,a as u,b as v}from"./QTable.54a77e6e.js";import{Q as w,a as f,b as m,c as y}from"./QPageSticky.a179ccb3.js";import{Q as _}from"./QPage.2fc420a1.js";import{T as k}from"./TouchPan.9047fff0.js";import{api as $}from"./axios.23aa70c0.js";import{e as F}from"./export-file.dc78ba05.js";import{u as C}from"./use-quasar.38626e8f.js";import{a as A}from"./authenticate.bcdfbf4f.js";import{h as P}from"./moment.9709ab41.js";import{_ as Q,n as q,o as p,c as b,w as a,f as T,a as o,e as s,aw as c,ah as x}from"./index.ef228992.js";import"./format.6bd9982d.js";import"./use-key-composition.25c6204a.js";import"./QItemLabel.1cc16253.js";import"./js.cookie.f93afda9.js";function g(e,i,n){let r=i!==void 0?i(e,n):e;return r=r==null?"":String(r),r=r.split('"').join('""'),`"${r}"`}const D=C(),B={name:"IngresoPage",data(){return{rows:[],columsfacturas:[{label:"Consecutivo Prefactura",name:"consecutivoprefactura",required:!0,align:"center",field:e=>e.consecutivoprefactura,format:e=>`${e}`,sortable:!0},{label:"Consecutivo Factura",name:"consecutivofactura",required:!0,align:"center",field:e=>e.consecutivofactura,format:e=>`${e}`,sortable:!0},{label:"Tipo",name:"tipo",required:!0,align:"center",field:e=>e.tipo,format:e=>`${e}`,sortable:!0},{label:"Proyecto",name:"nombreproyecto",required:!0,align:"lefth",field:e=>e.nombreproyecto,format:e=>`${e}`,sortable:!0},{label:"Cliente",name:"cliente.nombre",required:!0,align:"lefth",field:e=>e.cliente.nombre,format:e=>`${e}`,sortable:!0},{label:"Fecha",name:"createdAt",required:!0,align:"center",field:e=>e.createdAt,format:e=>`${e}`,sortable:!0},{label:"Estado",name:"status",required:!0,align:"center",field:e=>e.status,format:e=>`${e}`,sortable:!0}]}},components:{},methods:{loadFactura(){$.get("/factura/",{headers:{Authorization:`Bearer ${A.getUserLogged()}`}}).then(e=>{this.rows=e.data}).catch(e=>this.$q.notify({type:"negative",position:"top",message:e.response.data.message}))},onRowClick(e){const i=e.status;i=="CREADA"?this.$router.push({path:"/detailprefactura/"+e.id,params:{idfactura:e.id}}):i=="APROBADA"&&this.$router.push({path:"/detailfactura/"+e.id,params:{idfactura:e.id}})},OpenNewConduce(){this.$router.push("/newconduce")},FormatoFecha(e){return P(String(e)).format("MM/DD/YYYY hh:mm")},exportTable(){const e=[this.columns.map(n=>g(n.label))].concat(this.rows.map(n=>this.columns.map(r=>g(typeof r.field=="function"?r.field(n):n[r.field===void 0?r.name:r.field],r.format,n)).join(","))).join(`\r
`);F("table-export.csv",e,"text/csv")!==!0&&D.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})},OpenNewPrefactura(){this.$router.push("/addPrefactura")}},mounted(){this.loadFactura()},setup(){return{confirm:q(!1)}}},N={class:"q-pa-md"};function O(e,i,n,r,d,l){return p(),b(_,{class:"q-pa-md"},{default:a(()=>[T("div",N,[o(v,{flat:"",bordered:"",title:"Facturas y Prefacturas",rows:d.rows,columns:d.columsfacturas,color:"primary","row-key":"name"},{body:a(t=>[o(h,{props:t,onClick:R=>l.onRowClick(t.row)},{default:a(()=>[o(u,{key:"consecutivoprefactura",props:t},{default:a(()=>[s(c(t.row.consecutivoprefactura),1)]),_:2},1032,["props"]),o(u,{key:"consecutivofactura",props:t},{default:a(()=>[s(c(t.row.consecutivofactura),1)]),_:2},1032,["props"]),o(u,{key:"tipo",props:t},{default:a(()=>[s(c(t.row.tipo),1)]),_:2},1032,["props"]),o(u,{key:"nombreproyecto",props:t},{default:a(()=>[s(c(t.row.nombreproyecto),1)]),_:2},1032,["props"]),o(u,{key:"cliente.nombre",props:t},{default:a(()=>[s(c(t.row.cliente.nombre),1)]),_:2},1032,["props"]),o(u,{key:"createdAt",props:t},{default:a(()=>[s(c(l.FormatoFecha(t.row.createdAt)),1)]),_:2},1032,["props"]),o(u,{key:"status",props:t},{default:a(()=>[s(c(t.row.status),1)]),_:2},1032,["props"])]),_:2},1032,["props","onClick"])]),_:1},8,["rows","columns"])]),o(y,{position:"top-right",offset:[18,18]},{default:a(()=>[x((p(),b(w,{icon:"add",direction:"down",color:"primary",disable:e.draggingFab},{default:a(()=>[o(f,{onClick:i[0]||(i[0]=t=>l.exportTable()),color:"positive",icon:"download",disable:e.draggingFab},{default:a(()=>[o(m,null,{default:a(()=>[s(" Descargar ")]),_:1})]),_:1},8,["disable"]),o(f,{onClick:i[1]||(i[1]=t=>l.OpenNewPrefactura()),color:"positive",icon:"add_box",disable:e.draggingFab},{default:a(()=>[o(m,null,{default:a(()=>[s(" Adicionar ")]),_:1})]),_:1},8,["disable"])]),_:1},8,["disable"])),[[k,e.moveFab,void 0,{prevent:!0,mouse:!0}]])]),_:1})]),_:1})}var W=Q(B,[["render",O]]);export{W as default};
