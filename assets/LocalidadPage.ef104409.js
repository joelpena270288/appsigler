import{Q as k,a as x,b as E}from"./QTable.54a77e6e.js";import{_ as N,n as v,o as b,c as w,w as i,f as d,a as e,e as g,aw as A,N as h,J as m,af as p,M as c,ax as L,ah as q,Q as B}from"./index.ef228992.js";import{Q as C}from"./QInput.a2bee355.js";import{Q as y}from"./QCardActions.bed2bb53.js";import{Q as D,a as _,b as Q,c as T}from"./QPageSticky.a179ccb3.js";import{Q as U}from"./QPage.2fc420a1.js";import{T as S}from"./TouchPan.9047fff0.js";import{C as $}from"./ClosePopup.6197016b.js";import{api as u}from"./axios.23aa70c0.js";import{e as z}from"./export-file.dc78ba05.js";import{u as F}from"./use-quasar.38626e8f.js";import{a as f}from"./authenticate.bcdfbf4f.js";import"./format.6bd9982d.js";import"./use-key-composition.25c6204a.js";import"./QItemLabel.1cc16253.js";import"./js.cookie.f93afda9.js";function V(a,l,n){let t=l!==void 0?l(a,n):a;return t=t==null?"":String(t),t=t.split('"').join('""'),`"${t}"`}const P=F(),j={name:"LocalidadPage",data(){return{newLocalidad:!1,editLocalidad:!1,rows:[],columns:[{label:"Localidad",name:"name",required:!0,align:"center",field:a=>a.name,format:a=>`${a}`,sortable:!0}],localidades:[],localidad:{name:""},ideselected:0}},components:{},methods:{loadLocalidad(){u.get("/localidades/",{headers:{Authorization:`Bearer ${f.getUserLogged()}`}}).then(a=>{this.rows=a.data}).catch(a=>this.$q.notify({type:"negative",position:"top",message:a.response.data.message}))},OpenNewLocalidad(){this.localidad.name="",this.newLocalidad=!0},ClosedNewLocalidad(){this.localidad.name="",this.newLocalidad=!1},async AddLocalidad(){this.localidad.name!==""?(await u.post("/localidades/",this.localidad,{headers:{Authorization:`Bearer ${f.getUserLogged()}`}}).then(a=>{this.$q.notify({color:"positive",position:"top",message:"Se inserto la localidad "+a.data.name,icon:"done"})}).catch(a=>this.$q.notify({type:"negative",position:"top",message:a.response.data.message})),this.newLocalidad=!1,this.loadLocalidad()):this.$q.notify({color:"negative",position:"top",message:"Llene los capos requeridos",icon:"report_problem"})},OpenEdit(){this.editLocalidad=!0},async EditLocalidad(){this.localidad.name!==""?(await u.patch("/localidades/"+this.idselected,this.localidad,{headers:{Authorization:`Bearer ${f.getUserLogged()}`}}).then(a=>{this.$q.notify({color:"positive",position:"top",message:"Se Modifico la Localidad "+a.data.name,icon:"done"})}).catch(a=>this.$q.notify({type:"negative",position:"top",message:a.response.data.message})),this.editLocalidad=!1,this.loadLocalidad()):this.$q.notify({color:"negative",position:"top",message:"Llene los capos requeridos",icon:"report_problem"})},ClosedEditLocalidad(){this.localidad={},this.editLocalidad=!1},async DeleteLocalidad(){await u.delete("/localidades/"+this.idselected,{headers:{Authorization:`Bearer ${f.getUserLogged()}`}}).then(a=>{this.$q.notify({color:"positive",position:"top",message:"Se Elimino la localidad del sistema "+a.data.name,icon:"done"})}).catch(a=>this.$q.notify({type:"negative",position:"top",message:a.response.data.message})),this.confirm=!1,this.editLocalidad=!1,this.loadLocalidad()},onRowClick(a){this.localidad.name=a.name,this.idselected=a.id,this.editLocalidad=!0},exportTable(){const a=[this.columns.map(n=>V(n.label))].concat(this.rows.map(n=>this.columns.map(t=>V(typeof t.field=="function"?t.field(n):n[t.field===void 0?t.name:t.field],t.format,n)).join(","))).join(`\r
`);z("table-export.csv",a,"text/csv")!==!0&&P.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}},mounted(){this.loadLocalidad()},setup(){return{selected:v([]),confirm:v(!1)}}},O={class:"q-pa-md"},M={class:"q-pa-md q-gutter-sm"},R=d("div",{class:"text-h6"},"Nueva Localidad",-1),I={class:"q-pt-none",style:{"max-width":"700px"}},J={class:"q-pa-md q-gutter-sm"},G=d("div",{class:"text-h6"},"Editar Localidad",-1),H={class:"q-pt-none",style:{"max-width":"700px"}},K={class:"q-pa-md q-gutter-sm"},W=d("span",{class:"q-ml-sm"},"Desea eliminar la localidad?.",-1);function X(a,l,n,t,s,r){return b(),w(U,{class:"q-pa-md"},{default:i(()=>[d("div",O,[e(E,{flat:"",bordered:"",title:"Localidades",rows:s.rows,columns:s.columns,color:"primary","row-key":"name"},{body:i(o=>[e(k,{props:o,onClick:Y=>r.onRowClick(o.row)},{default:i(()=>[e(x,{key:"name",props:o},{default:i(()=>[g(A(o.row.name),1)]),_:2},1032,["props"])]),_:2},1032,["props","onClick"])]),_:1},8,["rows","columns"])]),d("template",null,[d("div",M,[e(L,{modelValue:s.newLocalidad,"onUpdate:modelValue":l[3]||(l[3]=o=>s.newLocalidad=o),persistent:""},{default:i(()=>[e(h,{class:"my-card",flat:"",bordered:""},{default:i(()=>[e(m,null,{default:i(()=>[R]),_:1}),e(p),e(m,null,{default:i(()=>[d("div",I,[e(C,{filled:"",modelValue:s.localidad.name,"onUpdate:modelValue":l[0]||(l[0]=o=>s.localidad.name=o),label:"Localidad *",hint:"Localidad","lazy-rules":"",rules:[o=>o&&o.length>0||"Debe introducir una localidad"]},null,8,["modelValue","rules"])])]),_:1}),e(p),e(y,null,{default:i(()=>[e(c,{label:"Enviar",icon:"send",type:"submit",color:"primary",flat:"",class:"q-ml-sm",onClick:l[1]||(l[1]=o=>r.AddLocalidad())}),e(c,{label:"Cancelar",icon:"cancel",type:"reset",color:"primary",flat:"",class:"q-ml-sm",onClick:l[2]||(l[2]=o=>r.ClosedNewLocalidad())})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),d("template",null,[d("div",J,[e(L,{modelValue:s.editLocalidad,"onUpdate:modelValue":l[8]||(l[8]=o=>s.editLocalidad=o),persistent:""},{default:i(()=>[e(h,{class:"my-card",flat:"",bordered:""},{default:i(()=>[e(m,null,{default:i(()=>[G]),_:1}),e(p),e(m,null,{default:i(()=>[d("div",H,[e(C,{filled:"",modelValue:s.localidad.name,"onUpdate:modelValue":l[4]||(l[4]=o=>s.localidad.name=o),label:"Localidad *",hint:"Localidad","lazy-rules":"",rules:[o=>o&&o.length>0||"Debe introducir una localidad"]},null,8,["modelValue","rules"])])]),_:1}),e(p),e(y,null,{default:i(()=>[e(c,{label:"Enviar",icon:"send",type:"submit",color:"primary",flat:"",class:"q-ml-sm",onClick:l[5]||(l[5]=o=>r.EditLocalidad())}),e(c,{label:"Eliminar",icon:"delete",type:"submit",color:"negative",flat:"",class:"q-ml-sm",onClick:l[6]||(l[6]=o=>t.confirm=!0)}),e(c,{label:"Cerrar",icon:"cancel",type:"cancel",color:"primary",flat:"",class:"q-ml-sm",onClick:l[7]||(l[7]=o=>r.ClosedEditLocalidad())})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),e(T,{position:"top-right",offset:[18,18]},{default:i(()=>[q((b(),w(D,{icon:"add",direction:"down",color:"primary",disable:a.draggingFab},{default:i(()=>[e(_,{onClick:l[9]||(l[9]=o=>r.exportTable()),color:"positive",icon:"download",disable:a.draggingFab},{default:i(()=>[e(Q,null,{default:i(()=>[g(" Descargar ")]),_:1})]),_:1},8,["disable"]),e(_,{onClick:l[10]||(l[10]=o=>r.OpenNewLocalidad()),color:"positive",icon:"add_box",disable:a.draggingFab},{default:i(()=>[e(Q,null,{default:i(()=>[g(" Nuevo ")]),_:1})]),_:1},8,["disable"])]),_:1},8,["disable"])),[[S,a.moveFab,void 0,{prevent:!0,mouse:!0}]])]),_:1}),d("template",null,[d("div",K,[e(L,{modelValue:t.confirm,"onUpdate:modelValue":l[12]||(l[12]=o=>t.confirm=o),persistent:""},{default:i(()=>[e(h,null,{default:i(()=>[e(m,{class:"row items-center"},{default:i(()=>[e(B,{icon:"priority_high",color:"primary","text-color":"white"}),W]),_:1}),e(y,{align:"right"},{default:i(()=>[q(e(c,{label:"Cancelar",icon:"cancel",type:"cancel",color:"primary",flat:"",class:"q-ml-sm"},null,512),[[$]]),e(c,{label:"Eliminar",icon:"delete",type:"submit",color:"negative",flat:"",class:"q-ml-sm",onClick:l[11]||(l[11]=o=>r.DeleteLocalidad())})]),_:1})]),_:1})]),_:1},8,["modelValue"])])])]),_:1})}var ge=N(j,[["render",X]]);export{ge as default};
