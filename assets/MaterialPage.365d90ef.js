import{Q as k,a as x,b as E}from"./QTable.54a77e6e.js";import{_ as N,n as v,o as b,c as w,w as l,f as o,a as e,e as g,aw as A,N as h,J as p,af as u,M as m,ax as M,ah as q,Q as B}from"./index.ef228992.js";import{Q as C}from"./QInput.a2bee355.js";import{Q as y}from"./QCardActions.bed2bb53.js";import{Q as D,a as _,b as Q,c as T}from"./QPageSticky.a179ccb3.js";import{Q as U}from"./QPage.2fc420a1.js";import{T as S}from"./TouchPan.9047fff0.js";import{C as $}from"./ClosePopup.6197016b.js";import{api as c}from"./axios.23aa70c0.js";import{e as z}from"./export-file.dc78ba05.js";import{u as F}from"./use-quasar.38626e8f.js";import{a as f}from"./authenticate.bcdfbf4f.js";import"./format.6bd9982d.js";import"./use-key-composition.25c6204a.js";import"./QItemLabel.1cc16253.js";import"./js.cookie.f93afda9.js";function V(a,t,n){let s=t!==void 0?t(a,n):a;return s=s==null?"":String(s),s=s.split('"').join('""'),`"${s}"`}const L=F(),P={name:"MaterialPage",data(){return{newMaterial:!1,editMaterial:!1,rows:[],columns:[{label:"Material",name:"name",required:!0,align:"center",field:a=>a.name,format:a=>`${a}`,sortable:!0}],materiales:[],material:{name:""},ideselected:0}},components:{},methods:{loadMaterial(){c.get("/material/",{headers:{Authorization:`Bearer ${f.getUserLogged()}`}}).then(a=>{this.rows=a.data}).catch(a=>this.$q.notify({type:"negative",position:"top",message:a.response.data.message}))},OpenNewMaterial(){this.material.name="",this.newMaterial=!0},ClosedNewMaterial(){this.material.name="",this.newMaterial=!1},async AddMaterial(){this.material.name!==""?(await c.post("/material/",this.material,{headers:{Authorization:`Bearer ${f.getUserLogged()}`}}).then(a=>{this.$q.notify({color:"positive",position:"top",message:"Se inserto el material "+a.data.name,icon:"done"})}).catch(a=>this.$q.notify({type:"negative",position:"top",message:a.response.data.message})),this.newMaterial=!1,this.loadMaterial()):this.$q.notify({color:"negative",position:"top",message:"Llene los capos requeridos",icon:"report_problem"})},OpenEdit(){this.editMaterial=!0},async EditMaterial(){this.material.name!==""?(await c.patch("/material/"+this.idselected,this.material,{headers:{Authorization:`Bearer ${f.getUserLogged()}`}}).then(a=>{this.$q.notify({color:"positive",position:"top",message:"Se Modifico el Material "+a.data.name,icon:"done"})}).catch(a=>this.$q.notify({type:"negative",position:"top",message:a.response.data.message})),this.editMaterial=!1,this.loadMaterial()):this.$q.notify({color:"negative",position:"top",message:"Llene los capos requeridos",icon:"report_problem"})},ClosedEditMaterial(){this.material={},this.editMaterial=!1},async DeleteMaterial(){await c.delete("/material/"+this.idselected,{headers:{Authorization:`Bearer ${f.getUserLogged()}`}}).then(a=>{this.$q.notify({color:"positive",position:"top",message:"Se Elimino el Material "+a.data.name,icon:"done"})}).catch(a=>this.$q.notify({type:"negative",position:"top",message:a.response.data.message})),this.confirm=!1,this.editMaterial=!1,this.loadMaterial()},onRowClick(a){this.material.name=a.name,this.idselected=a.id,this.editMaterial=!0},exportTable(){const a=[this.columns.map(n=>V(n.label))].concat(this.rows.map(n=>this.columns.map(s=>V(typeof s.field=="function"?s.field(n):n[s.field===void 0?s.name:s.field],s.format,n)).join(","))).join(`\r
`);z("table-export.csv",a,"text/csv")!==!0&&L.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}},mounted(){this.loadMaterial()},setup(){return{selected:v([]),confirm:v(!1)}}},j={class:"q-pa-md"},O={class:"q-pa-md q-gutter-sm"},R=o("div",{class:"text-h6"},"Nuevo Material",-1),I={class:"q-pt-none",style:{"max-width":"700px"}},J={class:"q-pa-md q-gutter-sm"},G=o("div",{class:"text-h6"},"Editar Material",-1),H={class:"q-pt-none",style:{"max-width":"700px"}},K={class:"q-pa-md q-gutter-sm"},W=o("span",{class:"q-ml-sm"},"Desea eliminar el Material?.",-1);function X(a,t,n,s,r,d){return b(),w(U,{class:"q-pa-md"},{default:l(()=>[o("div",j,[e(E,{flat:"",bordered:"",title:"Materiales",rows:r.rows,columns:r.columns,color:"primary","row-key":"name"},{body:l(i=>[e(k,{props:i,onClick:Y=>d.onRowClick(i.row)},{default:l(()=>[e(x,{key:"name",props:i},{default:l(()=>[g(A(i.row.name),1)]),_:2},1032,["props"])]),_:2},1032,["props","onClick"])]),_:1},8,["rows","columns"])]),o("template",null,[o("div",O,[e(M,{modelValue:r.newMaterial,"onUpdate:modelValue":t[3]||(t[3]=i=>r.newMaterial=i),persistent:""},{default:l(()=>[e(h,{class:"my-card",flat:"",bordered:""},{default:l(()=>[e(p,null,{default:l(()=>[R]),_:1}),e(u),e(p,null,{default:l(()=>[o("div",I,[e(C,{filled:"",modelValue:r.material.name,"onUpdate:modelValue":t[0]||(t[0]=i=>r.material.name=i),label:"Material *",hint:"Material","lazy-rules":"",rules:[i=>i&&i.length>0||"Debe introducir un Material"]},null,8,["modelValue","rules"])])]),_:1}),e(u),e(y,null,{default:l(()=>[e(m,{label:"Enviar",icon:"send",type:"submit",color:"primary",flat:"",class:"q-ml-sm",onClick:t[1]||(t[1]=i=>d.AddMaterial())}),e(m,{label:"Cancelar",icon:"cancel",type:"reset",color:"primary",flat:"",class:"q-ml-sm",onClick:t[2]||(t[2]=i=>d.ClosedNewMaterial())})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),o("template",null,[o("div",J,[e(M,{modelValue:r.editMaterial,"onUpdate:modelValue":t[8]||(t[8]=i=>r.editMaterial=i),persistent:""},{default:l(()=>[e(h,{class:"my-card",flat:"",bordered:""},{default:l(()=>[e(p,null,{default:l(()=>[G]),_:1}),e(u),e(p,null,{default:l(()=>[o("div",H,[e(C,{filled:"",modelValue:r.material.name,"onUpdate:modelValue":t[4]||(t[4]=i=>r.material.name=i),label:"Material *",hint:"Material","lazy-rules":"",rules:[i=>i&&i.length>0||"Debe introducir un Material"]},null,8,["modelValue","rules"])])]),_:1}),e(u),e(y,null,{default:l(()=>[e(m,{label:"Enviar",icon:"send",type:"submit",color:"primary",flat:"",class:"q-ml-sm",onClick:t[5]||(t[5]=i=>d.EditMaterial())}),e(m,{label:"Eliminar",icon:"delete",type:"submit",color:"negative",flat:"",class:"q-ml-sm",onClick:t[6]||(t[6]=i=>s.confirm=!0)}),e(m,{label:"Cerrar",icon:"cancel",type:"cancel",color:"primary",flat:"",class:"q-ml-sm",onClick:t[7]||(t[7]=i=>d.ClosedEditMaterial())})]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),e(T,{position:"top-right",offset:[18,18]},{default:l(()=>[q((b(),w(D,{icon:"add",direction:"down",color:"primary",disable:a.draggingFab},{default:l(()=>[e(_,{onClick:t[9]||(t[9]=i=>d.exportTable()),color:"positive",icon:"download",disable:a.draggingFab},{default:l(()=>[e(Q,null,{default:l(()=>[g(" Descargar ")]),_:1})]),_:1},8,["disable"]),e(_,{onClick:t[10]||(t[10]=i=>d.OpenNewMaterial()),color:"positive",icon:"add_box",disable:a.draggingFab},{default:l(()=>[e(Q,null,{default:l(()=>[g(" Nuevo ")]),_:1})]),_:1},8,["disable"])]),_:1},8,["disable"])),[[S,a.moveFab,void 0,{prevent:!0,mouse:!0}]])]),_:1}),o("template",null,[o("div",K,[e(M,{modelValue:s.confirm,"onUpdate:modelValue":t[12]||(t[12]=i=>s.confirm=i),persistent:""},{default:l(()=>[e(h,null,{default:l(()=>[e(p,{class:"row items-center"},{default:l(()=>[e(B,{icon:"priority_high",color:"primary","text-color":"white"}),W]),_:1}),e(y,{align:"right"},{default:l(()=>[q(e(m,{label:"Cancelar",icon:"cancel",type:"cancel",color:"primary",flat:"",class:"q-ml-sm"},null,512),[[$]]),e(m,{label:"Eliminar",icon:"delete",type:"submit",color:"negative",flat:"",class:"q-ml-sm",onClick:t[11]||(t[11]=i=>d.DeleteMaterial())})]),_:1})]),_:1})]),_:1},8,["modelValue"])])])]),_:1})}var ge=N(P,[["render",X]]);export{ge as default};
